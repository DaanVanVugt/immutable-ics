{"version":3,"file":"immutable-ics.cjs.js","sources":["../src/lib/formatDate.js","../src/lib/formatTime.js","../src/lib/formatDateTime.js","../src/lib/removeTimeZoneOffset.js","../src/transformers.js","../src/constants.js","../src/Property.js","../src/Component.js"],"sourcesContent":["import padStart from 'lodash.padstart'\n\n/**\n * Format a Date object to a valid DATE string.\n *\n * @private\n * @param {Date} date - Date to format.\n */\nexport default date => {\n  return (\n    date.getFullYear() +\n    padStart(date.getMonth() + 1, 2, 0) +\n    padStart(date.getDate(), 2, 0)\n  )\n}\n","import padStart from 'lodash.padstart'\n\n/**\n * Format a Date object to a valid TIME string.\n *\n * @private\n * @param {Date} date - Date to format.\n */\nexport default date => {\n  return (\n    padStart(date.getUTCHours(), 2, 0) +\n    padStart(date.getUTCMinutes(), 2, 0) +\n    padStart(date.getUTCSeconds(), 2, 0) +\n    'Z'\n  )\n}\n","import formatDate from './formatDate'\nimport formatTime from './formatTime'\n\n/**\n * Format a Date object to a valid DATE-TIME string.\n *\n * @private\n * @param {Date} date - Date to format.\n */\nexport default date => {\n  return `${formatDate(date)}T${formatTime(date)}`\n}\n","export default date => {\n  const offset = date.getTimezoneOffset() * 60000\n\n  return new Date(date.getTime() + offset)\n}\n","import isDate from 'lodash.isdate'\nimport formatDate from './lib/formatDate'\nimport formatDateTime from './lib/formatDateTime'\nimport formatTime from './lib/formatTime'\nimport removeTimeZoneOffset from './lib/removeTimeZoneOffset'\n\nexport const BOOLEAN = value => (value ? 'TRUE' : 'FALSE')\n\nexport const DATE = value =>\n  isDate(value) ? formatDate(removeTimeZoneOffset(value)) : value\n\nexport const DATETIME = value => (isDate(value) ? formatDateTime(value) : value)\n\nexport const FLOAT = value => Number.parseFloat(value)\n\n// Special case to force VERSION property to be a float with one decimal place.\nexport const FLOAT__FIXED_1 = (...args) => FLOAT(...args).toFixed(1)\n\nexport const INTEGER = value => Number.parseInt(value)\n\nexport const TEXT = value =>\n  value\n    .toString()\n    .replace(/\\\\/g, '\\\\\\\\')\n    .replace(/,/g, '\\\\,')\n    .replace(/;/g, '\\\\;')\n    .replace(/\\n/g, '\\\\n')\n\nexport const TIME = value =>\n  isDate(value) ? formatTime(removeTimeZoneOffset(value)) : value\n","export const FOLD_SEPARATOR = '\\r\\n '\nexport const LINE_SEPARATOR = '\\r\\n'\nexport const PARAMETER_SEPARATOR = ';'\nexport const PARAMETER_KV_SEPARATOR = '='\nexport const PARAMETER_VALUE_KEY = 'VALUE'\nexport const PROPERTY_KV_SEPARATOR = ':'\nexport const VALUE_SEPARATOR = ','\n\nexport const FOLD_REGEX = new RegExp(/[\\s\\S]{1,73}/g)\n\nexport const PREFIX = 'BEGIN'\nexport const SUFFIX = 'END'\n\nexport const VALUE_TYPES = {\n  BINARY: 'BINARY',\n  BOOLEAN: 'BOOLEAN',\n  CALADDRESS: 'CALADDRESS',\n  'CAL-ADDRESS': 'CALADDRESS',\n  DATE: 'DATE',\n  DATETIME: 'DATETIME',\n  'DATE-TIME': 'DATETIME',\n  DURATION: 'DURATION',\n  FLOAT: 'FLOAT',\n  INTEGER: 'INTEGER',\n  PERIOD: 'PERIOD',\n  RECUR: 'RECUR',\n  TEXT: 'TEXT',\n  TIME: 'TIME',\n  URI: 'URI',\n  UTCOFFSET: 'UTCOFFSET',\n  'UTC-OFFSET': 'UTCOFFSET',\n}\n\nexport const DEFAULT_VALUE_TYPE = VALUE_TYPES.TEXT\n\nexport const DEFAULT_VALUE_TYPES = {\n  ATTACH: VALUE_TYPES.URI,\n  ATTENDEE: VALUE_TYPES.CALADDRESS,\n  CREATED: VALUE_TYPES.DATETIME,\n  DTSTART: VALUE_TYPES.DATETIME,\n  DTEND: VALUE_TYPES.DATETIME,\n  DTSTAMP: VALUE_TYPES.DATETIME,\n  DUE: VALUE_TYPES.DATETIME,\n  DURATION: VALUE_TYPES.DURATION,\n  EXDATE: VALUE_TYPES.DATETIME,\n  FREEBUSY: VALUE_TYPES.PERIOD,\n  'LAST-MODIFIED': VALUE_TYPES.DATETIME,\n  ORGANIZER: VALUE_TYPES.CALADDRESS,\n  'PERCENT-COMPLETE': VALUE_TYPES.INTEGER,\n  PRIORITY: VALUE_TYPES.INTEGER,\n  RDATE: VALUE_TYPES.DATETIME,\n  'RECURRENCE-ID': VALUE_TYPES.DATETIME,\n  REPEAT: VALUE_TYPES.INTEGER,\n  RRULE: VALUE_TYPES.RECUR,\n  SEQUENCE: VALUE_TYPES.INTEGER,\n  TRIGGER: VALUE_TYPES.DURATION,\n  TZOFFSETFROM: VALUE_TYPES.UTCOFFSET,\n  TZOFFSETTO: VALUE_TYPES.UTCOFFSET,\n  TZURL: VALUE_TYPES.URI,\n  URL: VALUE_TYPES.URI,\n  VERSION: VALUE_TYPES.FLOAT + '__FIXED_1',\n}\n","import { Any, Map, Record } from 'typed-immutable'\nimport isFunction from 'lodash.isfunction'\nimport isNull from 'lodash.isnull'\nimport isUndefined from 'lodash.isundefined'\nimport * as transformers from './transformers'\nimport {\n  DEFAULT_VALUE_TYPE,\n  DEFAULT_VALUE_TYPES,\n  FOLD_REGEX,\n  FOLD_SEPARATOR,\n  PARAMETER_SEPARATOR,\n  PARAMETER_KV_SEPARATOR,\n  PARAMETER_VALUE_KEY,\n  PROPERTY_KV_SEPARATOR,\n  VALUE_SEPARATOR,\n  VALUE_TYPES,\n} from './constants'\n\nexport default class Property extends Record({\n  name: String,\n  parameters: Map(String, Any),\n  transform: Boolean(true),\n  value: Any,\n}) {\n  getTransformedValue() {\n    const valueType =\n      VALUE_TYPES[this.parameters.get(PARAMETER_VALUE_KEY)] ||\n      DEFAULT_VALUE_TYPES[this.name] ||\n      DEFAULT_VALUE_TYPE\n\n    const transformer = transformers[valueType]\n\n    if (!isFunction(transformer)) {\n      return this.value\n    }\n\n    if (Array.isArray(this.value)) {\n      return this.value\n        .map(item => transformer(item, this.parameters))\n        .join(VALUE_SEPARATOR)\n    }\n\n    return transformer(this.value, this.parameters)\n  }\n\n  toString() {\n    let string = this.name\n\n    if (this.parameters.size > 0) {\n      string +=\n        PARAMETER_SEPARATOR +\n        this.parameters\n          .entrySeq()\n          .map(([key, value]) => key + PARAMETER_KV_SEPARATOR + value)\n          .join(PARAMETER_SEPARATOR)\n    }\n\n    const value = this.transform ? this.getTransformedValue() : this.value\n\n    if (!isNull(value) && !isUndefined(value)) {\n      string += PROPERTY_KV_SEPARATOR + value\n    }\n\n    return string.match(FOLD_REGEX).join(FOLD_SEPARATOR)\n  }\n}\n","import { List, Record, Typed } from 'typed-immutable'\nimport Property from './Property'\nimport { LINE_SEPARATOR, PREFIX, SUFFIX } from './constants'\n\nTyped.Component = Typed(\n  'Component',\n  value =>\n    value instanceof Component\n      ? value\n      : TypeError(`\"${value}\" is not a Component`)\n)\n\nTyped.Property = Typed(\n  'Property',\n  value =>\n    value instanceof Property\n      ? value\n      : TypeError(`\"${value}\" is not a Property`)\n)\n\nexport default class Component extends Record({\n  name: String,\n  components: List(Typed.Component),\n  properties: List(Typed.Property),\n}) {\n  pushComponent(component) {\n    return this.update('components', v => v.push(component))\n  }\n\n  pushProperty(property) {\n    return this.update('properties', v => v.push(property))\n  }\n\n  clear() {\n    return this.clearComponents().clearProperties()\n  }\n\n  clearComponents() {\n    return this.remove('components')\n  }\n\n  clearProperties() {\n    return this.remove('properties')\n  }\n\n  toString() {\n    return [\n      new Property({ name: PREFIX, value: this.name }),\n      ...this.properties,\n      ...this.components,\n      new Property({ name: SUFFIX, value: this.name }),\n    ].join(LINE_SEPARATOR)\n  }\n}\n"],"names":["getFullYear","padStart","getMonth","getDate","getUTCHours","getUTCMinutes","getUTCSeconds","formatTime","getTimezoneOffset","getTime","formatDate","removeTimeZoneOffset","formatDateTime","parseFloat","toFixed","parseInt","toString","replace","BINARY","BOOLEAN","CALADDRESS","DATE","DATETIME","DURATION","FLOAT","INTEGER","PERIOD","RECUR","TEXT","TIME","URI","UTCOFFSET","VALUE_TYPES","ATTACH","ATTENDEE","CREATED","DTSTART","DTEND","DTSTAMP","DUE","EXDATE","FREEBUSY","ORGANIZER","PRIORITY","RDATE","REPEAT","RRULE","SEQUENCE","TRIGGER","TZOFFSETFROM","TZOFFSETTO","TZURL","URL","VERSION","parameters","get","PARAMETER_VALUE_KEY","DEFAULT_VALUE_TYPES","name","DEFAULT_VALUE_TYPE","transformers","Array","isArray","value","map","join","VALUE_SEPARATOR","size","PARAMETER_SEPARATOR","entrySeq","PARAMETER_KV_SEPARATOR","transform","getTransformedValue","isUndefined","PROPERTY_KV_SEPARATOR","match","FOLD_REGEX","FOLD_SEPARATOR","Record","String","Map","Any","Typed","Component","TypeError","Property","update","push","clearComponents","clearProperties","remove","PREFIX","properties","components","SUFFIX","LINE_SEPARATOR","List"],"mappings":"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"}